

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Modules &mdash; Volumential 2017.1alpha documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="../_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script type="text/javascript" src="../_static/jquery.js"></script>
        <script type="text/javascript" src="../_static/underscore.js"></script>
        <script type="text/javascript" src="../_static/doctools.js"></script>
        <script type="text/javascript" src="../_static/language_data.js"></script>
        <script async="async" type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML"></script>
    
    <script type="text/javascript" src="../_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Documentation Guide" href="../sphinx.html" />
    <link rel="prev" title="Installation and Setup" href="../install.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../index.html" class="icon icon-home"> Volumential
          

          
          </a>

          
            
            
              <div class="version">
                2017
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../intro.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../install.html">Installation and Setup</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Modules</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#box-mesh-generation">Box Mesh Generation</a></li>
<li class="toctree-l2"><a class="reference internal" href="#singular-integrals">Singular Integrals</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#transform-method">Transform Method</a></li>
<li class="toctree-l3"><a class="reference internal" href="#droste-method">Droste Method</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#near-field-tabulation">Near-Field Tabulation</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#symmetry-discovery">Symmetry Discovery</a></li>
<li class="toctree-l3"><a class="reference internal" href="#interaction-enumeration">Interaction Enumeration</a></li>
<li class="toctree-l3"><a class="reference internal" href="#table-lookup-deprecated">Table Lookup (Deprecated)</a></li>
<li class="toctree-l3"><a class="reference internal" href="#table-and-table-manager">Table and Table Manager</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#module-volumential.expansion_wrangler_interface">Multipole/Local Expansions</a></li>
<li class="toctree-l2"><a class="reference internal" href="#volume-fmm">Volume FMM</a></li>
<li class="toctree-l2"><a class="reference internal" href="#function-extension">Function Extension</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-volumential.tools">Miscellaneous Tools</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../sphinx.html">Documentation Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../indices_tables.html">Indices and tables</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">Volumential</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html">Docs</a> &raquo;</li>
        
      <li>Modules</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../_sources/api/modules.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="modules">
<h1>Modules<a class="headerlink" href="#modules" title="Permalink to this headline">¶</a></h1>
<div class="section" id="box-mesh-generation">
<h2>Box Mesh Generation<a class="headerlink" href="#box-mesh-generation" title="Permalink to this headline">¶</a></h2>
<p>The volume FMM operates over a box-shaped mesh generated by <a class="reference internal" href="#module-volumential.meshgen" title="volumential.meshgen"><code class="xref py py-mod docutils literal notranslate"><span class="pre">volumential.meshgen</span></code></a>. It consists of two backends: a Python one that only generates uniform mesh, and a C++ one that is capable of performing adaptive mesh refinement.</p>
<span class="target" id="module-volumential.meshgen"></span><p>Mesh generation</p>
<dl class="class">
<dt id="volumential.meshgen.MeshGenBase">
<em class="property">class </em><code class="sig-prename descclassname">volumential.meshgen.</code><code class="sig-name descname">MeshGenBase</code><span class="sig-paren">(</span><em class="sig-param">degree</em>, <em class="sig-param">nlevels</em>, <em class="sig-param">a=-1</em>, <em class="sig-param">b=1</em>, <em class="sig-param">queue=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/volumential/meshgen.html#MeshGenBase"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#volumential.meshgen.MeshGenBase" title="Permalink to this definition">¶</a></dt>
<dd><p>Base class for Meshgen via BoxTree.
The interface is similar to the Meshgen via Deal.II, except that
the arguments a and b can also be of higher dimensions to allow
added flexibility on choosing the bounding box.</p>
<p>This base class cannot be used directly since the boxtree is not
built in the constructor until dimension_specific_setup() is
provided.</p>
<p>In addition to the common capabilities of the deal.II implementation,
this class also implements native CL getters like get_q_points_dev()
that play well with the other libraries like boxtree.</p>
<dl class="method">
<dt id="volumential.meshgen.MeshGenBase.generate_gmsh">
<code class="sig-name descname">generate_gmsh</code><span class="sig-paren">(</span><em class="sig-param">filename</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/volumential/meshgen.html#MeshGenBase.generate_gmsh"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#volumential.meshgen.MeshGenBase.generate_gmsh" title="Permalink to this definition">¶</a></dt>
<dd><p># TODO
Write the active boxes as a gmsh file.
The file format specifications can be found at:
<a class="reference external" href="http://gmsh.info/doc/texinfo/gmsh.html#MSH-ASCII-file-format">http://gmsh.info/doc/texinfo/gmsh.html#MSH-ASCII-file-format</a></p>
</dd></dl>

<dl class="method">
<dt id="volumential.meshgen.MeshGenBase.n_cells">
<code class="sig-name descname">n_cells</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/volumential/meshgen.html#MeshGenBase.n_cells"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#volumential.meshgen.MeshGenBase.n_cells" title="Permalink to this definition">¶</a></dt>
<dd><p>Note that this value can be larger than the actual number
of cells used in the boxtree. It mainly serves as the bound for
iterators on cells.</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="volumential.meshgen.MeshGen2D">
<em class="property">class </em><code class="sig-prename descclassname">volumential.meshgen.</code><code class="sig-name descname">MeshGen2D</code><span class="sig-paren">(</span><em class="sig-param">degree</em>, <em class="sig-param">nlevels</em>, <em class="sig-param">a=-1</em>, <em class="sig-param">b=1</em>, <em class="sig-param">queue=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/volumential/meshgen.html#MeshGen2D"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#volumential.meshgen.MeshGen2D" title="Permalink to this definition">¶</a></dt>
<dd><p>Meshgen in 2D</p>
</dd></dl>

<dl class="class">
<dt id="volumential.meshgen.MeshGen3D">
<em class="property">class </em><code class="sig-prename descclassname">volumential.meshgen.</code><code class="sig-name descname">MeshGen3D</code><span class="sig-paren">(</span><em class="sig-param">degree</em>, <em class="sig-param">nlevels</em>, <em class="sig-param">a=-1</em>, <em class="sig-param">b=1</em>, <em class="sig-param">queue=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/volumential/meshgen.html#MeshGen3D"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#volumential.meshgen.MeshGen3D" title="Permalink to this definition">¶</a></dt>
<dd><p>Meshgen in 3D</p>
</dd></dl>

</div>
<div class="section" id="singular-integrals">
<h2>Singular Integrals<a class="headerlink" href="#singular-integrals" title="Permalink to this headline">¶</a></h2>
<div class="section" id="transform-method">
<h3>Transform Method<a class="headerlink" href="#transform-method" title="Permalink to this headline">¶</a></h3>
<p>(2D only) use Duffy-type transforms to desingularize the integrands.
Good at special kernel types (specifically <code class="docutils literal notranslate"><span class="pre">1/r</span></code>). The main downside of this method is its
complicated control flow (inefficient to parallelize). Thus it only supports CPU multi-threading, and extra dependency <code class="docutils literal notranslate"><span class="pre">dill</span></code> is needed for it.</p>
<span class="target" id="module-volumential.singular_integral_2d"></span><p>The 2D singular integrals are computed using the transform
described in <a class="reference external" href="http://link.springer.com/10.1007/BF00370482">http://link.springer.com/10.1007/BF00370482</a>.</p>
<dl class="function">
<dt id="volumential.singular_integral_2d.box_quad">
<code class="sig-prename descclassname">volumential.singular_integral_2d.</code><code class="sig-name descname">box_quad</code><span class="sig-paren">(</span><em class="sig-param">func</em>, <em class="sig-param">a</em>, <em class="sig-param">b</em>, <em class="sig-param">c</em>, <em class="sig-param">d</em>, <em class="sig-param">singular_point</em>, <em class="sig-param">args=()</em>, <em class="sig-param">tol=1.49e-08</em>, <em class="sig-param">rtol=1.49e-08</em>, <em class="sig-param">maxiter=50</em>, <em class="sig-param">vec_func=True</em>, <em class="sig-param">miniter=1</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/volumential/singular_integral_2d.html#box_quad"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#volumential.singular_integral_2d.box_quad" title="Permalink to this definition">¶</a></dt>
<dd><dl class="simple">
<dt>Computes a (tensor product) double integral, with the integrand being</dt><dd><p>singular at some point inside the region.</p>
</dd>
</dl>
<p>Integrate func on [a, b]X[c, d] using transformed Gaussian quadrature with
absolute tolerance tol.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>func</strong> (<em>function.</em>) – A double variable Python function or method to integrate.</p></li>
<li><p><strong>a</strong> (<em>float.</em>) – Lower-left corner of integration region.</p></li>
<li><p><strong>b</strong> (<em>float.</em>) – Lower-right corner of integration region.</p></li>
<li><p><strong>c</strong> (<em>float.</em>) – Upper-left corner of integration region.</p></li>
<li><p><strong>d</strong> (<em>float.</em>) – Upper-right corner of integration region.</p></li>
<li><p><strong>singular_point</strong> (<em>tuple</em><em>(</em><em>float</em><em>, </em><em>float</em><em>)</em><em></em>) – The singular point of the integrand func.</p></li>
<li><p><strong>args</strong> (<em>tuple</em><em>, </em><em>optional.</em>) – Extra arguments to pass to function.</p></li>
<li><p><strong>tol</strong> (<em>float</em><em>, </em><em>optional.</em>) – rtol Iteration stops when error between last two iterates is
less than tol OR the relative change is less than rtol.</p></li>
<li><p><strong>rtol</strong> (<em>float</em><em>, </em><em>optional.</em>) – Iteration stops when error between last two iterates is less
than tol OR the relative change is less than rtol.</p></li>
<li><p><strong>maxiter</strong> (<em>int</em><em>, </em><em>optional.</em>) – Maximum order of Gaussian quadrature.</p></li>
<li><p><strong>vec_func</strong> (<em>bool</em><em>, </em><em>optional.</em>) – True if func handles arrays as arguments (is a “vector”
function). Default is True.</p></li>
<li><p><strong>miniter</strong> (<em>int</em><em>, </em><em>optional.</em>) – Minimum order of Gaussian quadrature.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>val</strong>: Gaussian quadrature approximation (within tolerance) to integral.</p></li>
<li><p><strong>err</strong>: Difference between last two estimates of the integral.</p></li>
</ul>
</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>tuple(float,float)</p>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="droste-method">
<h3>Droste Method<a class="headerlink" href="#droste-method" title="Permalink to this headline">¶</a></h3>
<p>Use recursive brick-shaped subdivision, combined with simple bilinear transforms. The implementation is for 2/3D, written in <code class="docutils literal notranslate"><span class="pre">loopy</span></code> and is optimized to take advantage of symmetries.</p>
<span class="target" id="module-volumential.droste"></span><dl class="class">
<dt id="volumential.droste.DrosteBase">
<em class="property">class </em><code class="sig-prename descclassname">volumential.droste.</code><code class="sig-name descname">DrosteBase</code><span class="sig-paren">(</span><em class="sig-param">integral_knl</em>, <em class="sig-param">quad_order</em>, <em class="sig-param">case_vecs</em>, <em class="sig-param">n_brick_quad_points=15</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/volumential/droste.html#DrosteBase"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#volumential.droste.DrosteBase" title="Permalink to this definition">¶</a></dt>
<dd><p>Base class for Droste methods.
It uses sumpy tools to cache the loopy kernel.</p>
<dl class="attribute">
<dt id="volumential.droste.DrosteBase.integral_knl">
<code class="sig-name descname">integral_knl</code><a class="headerlink" href="#volumential.droste.DrosteBase.integral_knl" title="Permalink to this definition">¶</a></dt>
<dd><p>The integral kernel of sumpy.kernel type.</p>
</dd></dl>

<dl class="attribute">
<dt id="volumential.droste.DrosteBase.interaction_case_vecs">
<code class="sig-name descname">interaction_case_vecs</code><a class="headerlink" href="#volumential.droste.DrosteBase.interaction_case_vecs" title="Permalink to this definition">¶</a></dt>
<dd><p>The relative positions of the target box for each case.</p>
</dd></dl>

<dl class="attribute">
<dt id="volumential.droste.DrosteBase.interaction_case_scls">
<code class="sig-name descname">interaction_case_scls</code><a class="headerlink" href="#volumential.droste.DrosteBase.interaction_case_scls" title="Permalink to this definition">¶</a></dt>
<dd><p>The relative sizes of the target box for each case.</p>
</dd></dl>

<dl class="method">
<dt id="volumential.droste.DrosteBase.codegen_basis_eval">
<code class="sig-name descname">codegen_basis_eval</code><span class="sig-paren">(</span><em class="sig-param">iaxis</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/volumential/droste.html#DrosteBase.codegen_basis_eval"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#volumential.droste.DrosteBase.codegen_basis_eval" title="Permalink to this definition">¶</a></dt>
<dd><p>Generate instructions to evaluate Chebyshev polynomial basis.
(Chebyshev polynomials of the first kind T_n).</p>
</dd></dl>

<dl class="method">
<dt id="volumential.droste.DrosteBase.make_result_array">
<code class="sig-name descname">make_result_array</code><span class="sig-paren">(</span><em class="sig-param">**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/volumential/droste.html#DrosteBase.make_result_array"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#volumential.droste.DrosteBase.make_result_array" title="Permalink to this definition">¶</a></dt>
<dd><p>Allocate memory space for results.</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="volumential.droste.DrosteFull">
<em class="property">class </em><code class="sig-prename descclassname">volumential.droste.</code><code class="sig-name descname">DrosteFull</code><span class="sig-paren">(</span><em class="sig-param">integral_knl</em>, <em class="sig-param">quad_order</em>, <em class="sig-param">case_vecs</em>, <em class="sig-param">n_brick_quad_points=50</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/volumential/droste.html#DrosteFull"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#volumential.droste.DrosteFull" title="Permalink to this definition">¶</a></dt>
<dd><p>Build the full table directly.</p>
<dl class="method">
<dt id="volumential.droste.DrosteFull.call_loopy_kernel">
<code class="sig-name descname">call_loopy_kernel</code><span class="sig-paren">(</span><em class="sig-param">queue</em>, <em class="sig-param">**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/volumential/droste.html#DrosteFull.call_loopy_kernel"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#volumential.droste.DrosteFull.call_loopy_kernel" title="Permalink to this definition">¶</a></dt>
<dd><p>:arg source_box_extent
:arg alpha
:arg nlevels
:arg extra_kernel_kwargs</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="volumential.droste.DrosteReduced">
<em class="property">class </em><code class="sig-prename descclassname">volumential.droste.</code><code class="sig-name descname">DrosteReduced</code><span class="sig-paren">(</span><em class="sig-param">integral_knl=None</em>, <em class="sig-param">quad_order=None</em>, <em class="sig-param">case_vecs=None</em>, <em class="sig-param">n_brick_quad_points=50</em>, <em class="sig-param">knl_symmetry_tags=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/volumential/droste.html#DrosteReduced"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#volumential.droste.DrosteReduced" title="Permalink to this definition">¶</a></dt>
<dd><p>Reduce the workload by only building part of the table and infer the
rest of the table by symmetry.</p>
<dl class="method">
<dt id="volumential.droste.DrosteReduced.call_loopy_kernel_case">
<code class="sig-name descname">call_loopy_kernel_case</code><span class="sig-paren">(</span><em class="sig-param">queue</em>, <em class="sig-param">base_case_id</em>, <em class="sig-param">**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/volumential/droste.html#DrosteReduced.call_loopy_kernel_case"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#volumential.droste.DrosteReduced.call_loopy_kernel_case" title="Permalink to this definition">¶</a></dt>
<dd><p>Call the table builder on one base case, as given in :self.current_base_case:
:arg source_box_extent
:arg alpha
:arg nlevels
:arg extra_kernel_kwargs</p>
</dd></dl>

<dl class="method">
<dt id="volumential.droste.DrosteReduced.get_kernel">
<code class="sig-name descname">get_kernel</code><span class="sig-paren">(</span><em class="sig-param">**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/volumential/droste.html#DrosteReduced.get_kernel"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#volumential.droste.DrosteReduced.get_kernel" title="Permalink to this definition">¶</a></dt>
<dd><p>Reduced Droste is a 2-staged algorithm. The first stage uses the
kernel from DrosteBase to build part of the table. In the second
stage, an expansion kernel is called to fill the empty entries.</p>
</dd></dl>

<dl class="method">
<dt id="volumential.droste.DrosteReduced.get_kernel_expansion_by_symmetry_code">
<code class="sig-name descname">get_kernel_expansion_by_symmetry_code</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/volumential/droste.html#DrosteReduced.get_kernel_expansion_by_symmetry_code"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#volumential.droste.DrosteReduced.get_kernel_expansion_by_symmetry_code" title="Permalink to this definition">¶</a></dt>
<dd><p>Extra assignments that performs expansion by symmetry within the
current case.</p>
</dd></dl>

<dl class="method">
<dt id="volumential.droste.DrosteReduced.make_result_array">
<code class="sig-name descname">make_result_array</code><span class="sig-paren">(</span><em class="sig-param">**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/volumential/droste.html#DrosteReduced.make_result_array"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#volumential.droste.DrosteReduced.make_result_array" title="Permalink to this definition">¶</a></dt>
<dd><p>Allocate memory space for results.</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="volumential.droste.InverseDrosteReduced">
<em class="property">class </em><code class="sig-prename descclassname">volumential.droste.</code><code class="sig-name descname">InverseDrosteReduced</code><span class="sig-paren">(</span><em class="sig-param">integral_knl</em>, <em class="sig-param">quad_order</em>, <em class="sig-param">case_vecs</em>, <em class="sig-param">n_brick_quad_points=50</em>, <em class="sig-param">knl_symmetry_tags=None</em>, <em class="sig-param">auto_windowing=True</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/volumential/droste.html#InverseDrosteReduced"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#volumential.droste.InverseDrosteReduced" title="Permalink to this definition">¶</a></dt>
<dd><p>A variant of the Droste method.
Instead of computing a volume potential, it computes the “inverse” to a
Riesz potential, aka a “fractional Laplacian”.</p>
<p>Specifically, given an integral kernel G(r), this class supports the
precomputation for integrals of the form</p>
<div class="math notranslate nohighlight">
\[\int_B G(r) (u(x) - u(y)) dy\]</div>
<p>For k-dimensional fractional Laplacian, <span class="math notranslate nohighlight">\(G(r) = \frac{1}{r^{k+2s}}\)</span>.</p>
<p>The core part of concern (that is to be modified based on DrosteReduces):</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">...</span>

<span class="k">for</span> <span class="n">BASIS_VARS</span><span class="p">,</span> <span class="n">TGT_VARS</span><span class="p">,</span> <span class="n">icase</span>
    <span class="k">for</span> <span class="n">ilevel</span>
        <span class="k">for</span> <span class="n">ibrick_axis</span><span class="p">,</span> <span class="n">ibrick_side</span><span class="p">,</span> <span class="n">QUAD_VARS</span>

            <span class="n">PREPARE_BASIS_VALS</span>

            <span class="o">&lt;&gt;</span> <span class="n">density_val</span> <span class="o">=</span> <span class="n">DENSITY_VAL_ASSIGNMENT</span> \
                    <span class="p">{</span><span class="nb">id</span><span class="o">=</span><span class="n">density</span><span class="p">,</span><span class="n">dep</span><span class="o">=</span><span class="n">basis_evals</span><span class="p">}</span>

        <span class="n">end</span>
    <span class="n">end</span>
<span class="n">end</span>

<span class="o">...</span>
</pre></div>
</div>
<dl class="method">
<dt id="volumential.droste.InverseDrosteReduced.call_loopy_kernel_case">
<code class="sig-name descname">call_loopy_kernel_case</code><span class="sig-paren">(</span><em class="sig-param">queue</em>, <em class="sig-param">base_case_id</em>, <em class="sig-param">**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/volumential/droste.html#InverseDrosteReduced.call_loopy_kernel_case"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#volumential.droste.InverseDrosteReduced.call_loopy_kernel_case" title="Permalink to this definition">¶</a></dt>
<dd><p>Call the table builder on one base case, as given in :self.current_base_case:
:arg source_box_extent
:arg alpha
:arg delta
:arg nlevels
:arg extra_kernel_kwargs</p>
</dd></dl>

<dl class="method">
<dt id="volumential.droste.InverseDrosteReduced.codegen_basis_tgt_eval">
<code class="sig-name descname">codegen_basis_tgt_eval</code><span class="sig-paren">(</span><em class="sig-param">iaxis</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/volumential/droste.html#InverseDrosteReduced.codegen_basis_tgt_eval"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#volumential.droste.InverseDrosteReduced.codegen_basis_tgt_eval" title="Permalink to this definition">¶</a></dt>
<dd><p>Generate instructions to evaluate Chebyshev polynomial basis
at the target point, given that the target point lies in the
source box. (Chebyshev polynomials of the first kind T_n).</p>
<p>If the target point is not in the source box, the concerned instructions
will return 0.</p>
</dd></dl>

<dl class="method">
<dt id="volumential.droste.InverseDrosteReduced.codegen_der2_basis_tgt_eval">
<code class="sig-name descname">codegen_der2_basis_tgt_eval</code><span class="sig-paren">(</span><em class="sig-param">iaxis</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/volumential/droste.html#InverseDrosteReduced.codegen_der2_basis_tgt_eval"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#volumential.droste.InverseDrosteReduced.codegen_der2_basis_tgt_eval" title="Permalink to this definition">¶</a></dt>
<dd><p>Generate instructions to evaluate the second order derivatives
of Chebyshev polynomial basis at the target point, given that the target
lies in the source box. (Chebyshev polynomials of the first kind T_n).</p>
<p>If the target point is not in the source box, the concerned instructions
will return 0.</p>
<p>The evaluation is based on Chebyshev polynomials of the second kind
<span class="math notranslate nohighlight">\(U_n\)</span>.</p>
<div class="math notranslate nohighlight">
\[\frac{d^2 T_n}{dx^2} = n \frac{(n+1)T_n - U_n}{x^2 - 1}\]</div>
</dd></dl>

<dl class="method">
<dt id="volumential.droste.InverseDrosteReduced.codegen_windowing_function">
<code class="sig-name descname">codegen_windowing_function</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/volumential/droste.html#InverseDrosteReduced.codegen_windowing_function"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#volumential.droste.InverseDrosteReduced.codegen_windowing_function" title="Permalink to this definition">¶</a></dt>
<dd><p>Given <span class="math notranslate nohighlight">\(dist = x - y\)</span>, compute the windowing function.</p>
</dd></dl>

<dl class="method">
<dt id="volumential.droste.InverseDrosteReduced.get_kernel">
<code class="sig-name descname">get_kernel</code><span class="sig-paren">(</span><em class="sig-param">**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/volumential/droste.html#InverseDrosteReduced.get_kernel"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#volumential.droste.InverseDrosteReduced.get_kernel" title="Permalink to this definition">¶</a></dt>
<dd><p>Get loopy kernel for computation, the get_kernel_id determines
what task to perform.</p>
<ul class="simple">
<li><p>0:    Integrate <span class="math notranslate nohighlight">\(W(r) G(r) [u(x) - u(y) + grad(u)(y - x)]\)</span></p></li>
<li><p>1:    Add the integral of <span class="math notranslate nohighlight">\([1 - W(r)] G(r) [u(x) - u(y)]\)</span></p></li>
<li><p>2:    Expansion by symmetry.</p></li>
</ul>
</dd></dl>

<dl class="method">
<dt id="volumential.droste.InverseDrosteReduced.make_dim_independent">
<code class="sig-name descname">make_dim_independent</code><span class="sig-paren">(</span><em class="sig-param">knlstring</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/volumential/droste.html#InverseDrosteReduced.make_dim_independent"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#volumential.droste.InverseDrosteReduced.make_dim_independent" title="Permalink to this definition">¶</a></dt>
<dd><p>Produce the correct
<span class="math notranslate nohighlight">\(\text{DENSITY_VAL_ASSIGNMENT} = u(x) - u(y)\)</span>
for self-interactions.</p>
</dd></dl>

</dd></dl>

</div>
</div>
<div class="section" id="near-field-tabulation">
<h2>Near-Field Tabulation<a class="headerlink" href="#near-field-tabulation" title="Permalink to this headline">¶</a></h2>
<div class="section" id="symmetry-discovery">
<h3>Symmetry Discovery<a class="headerlink" href="#symmetry-discovery" title="Permalink to this headline">¶</a></h3>
<p>The set of symmetry operations that can be used to speed up precomputation depends on the dimension and symmetry properties of the kernel (e.g., is it a fundamental solution kernel or one of its derivatives?).</p>
<span class="target" id="module-volumential.list1_symmetry"></span><dl class="class">
<dt id="volumential.list1_symmetry.CaseVecReduction">
<em class="property">class </em><code class="sig-prename descclassname">volumential.list1_symmetry.</code><code class="sig-name descname">CaseVecReduction</code><span class="sig-paren">(</span><em class="sig-param">vecs=None</em>, <em class="sig-param">sym_tags=None</em>, <em class="sig-param">do_reduction=True</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/volumential/list1_symmetry.html#CaseVecReduction"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#volumential.list1_symmetry.CaseVecReduction" title="Permalink to this definition">¶</a></dt>
<dd><p>Reduce a set of case vectors based on symmetry.</p>
<dl class="method">
<dt id="volumential.list1_symmetry.CaseVecReduction.find_invariant_group">
<code class="sig-name descname">find_invariant_group</code><span class="sig-paren">(</span><em class="sig-param">vec</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/volumential/list1_symmetry.html#CaseVecReduction.find_invariant_group"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#volumential.list1_symmetry.CaseVecReduction.find_invariant_group" title="Permalink to this definition">¶</a></dt>
<dd><p>For a given case vector, within the allowed symmetry tags,
return a generating set of its invariant group as a list of
SymmetryOperationBase objects.</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="volumential.list1_symmetry.Flip">
<em class="property">class </em><code class="sig-prename descclassname">volumential.list1_symmetry.</code><code class="sig-name descname">Flip</code><span class="sig-paren">(</span><em class="sig-param">iaxis</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/volumential/list1_symmetry.html#Flip"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#volumential.list1_symmetry.Flip" title="Permalink to this definition">¶</a></dt>
<dd><p>Flip the sign of an axis, spanning S_2^dim</p>
</dd></dl>

<dl class="class">
<dt id="volumential.list1_symmetry.Swap">
<em class="property">class </em><code class="sig-prename descclassname">volumential.list1_symmetry.</code><code class="sig-name descname">Swap</code><span class="sig-paren">(</span><em class="sig-param">iaxis</em>, <em class="sig-param">jaxis</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/volumential/list1_symmetry.html#Swap"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#volumential.list1_symmetry.Swap" title="Permalink to this definition">¶</a></dt>
<dd><p>Swap two axes, spanning S_dim</p>
</dd></dl>

</div>
<div class="section" id="interaction-enumeration">
<h3>Interaction Enumeration<a class="headerlink" href="#interaction-enumeration" title="Permalink to this headline">¶</a></h3>
<p>This module enumerates the set of interaction cases that could possibly happen in <em>list1</em>.</p>
<span class="target" id="module-volumential.list1_gallery"></span><dl class="function">
<dt id="volumential.list1_gallery.generate_list1_gallery">
<code class="sig-prename descclassname">volumential.list1_gallery.</code><code class="sig-name descname">generate_list1_gallery</code><span class="sig-paren">(</span><em class="sig-param">dim</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/volumential/list1_gallery.html#generate_list1_gallery"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#volumential.list1_gallery.generate_list1_gallery" title="Permalink to this definition">¶</a></dt>
<dd><p>Generate a <em>list1</em> that servers as the gallery for all possible <em>list1</em>
interactions with given dimension and order.</p>
</dd></dl>

</div>
<div class="section" id="table-lookup-deprecated">
<h3>Table Lookup (Deprecated)<a class="headerlink" href="#table-lookup-deprecated" title="Permalink to this headline">¶</a></h3>
<p>This module produces table lookup schemes given information about the kernel and the table data format. The module is deprecated in favor of <a class="reference internal" href="#module-volumential.nearfield_potential_table" title="volumential.nearfield_potential_table"><code class="xref py py-mod docutils literal notranslate"><span class="pre">volumential.nearfield_potential_table</span></code></a> and <a class="reference internal" href="#module-volumential.table_manager" title="volumential.table_manager"><code class="xref py py-mod docutils literal notranslate"><span class="pre">volumential.table_manager</span></code></a>.</p>
<span class="target" id="module-volumential.list1"></span><dl class="class">
<dt id="volumential.list1.NearFieldEvalBase">
<em class="property">class </em><code class="sig-prename descclassname">volumential.list1.</code><code class="sig-name descname">NearFieldEvalBase</code><span class="sig-paren">(</span><em class="sig-param">integral_kernel</em>, <em class="sig-param">table_data_shapes</em>, <em class="sig-param">potential_kind=1</em>, <em class="sig-param">options=[]</em>, <em class="sig-param">name=None</em>, <em class="sig-param">device=None</em>, <em class="sig-param">**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/volumential/list1.html#NearFieldEvalBase"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#volumential.list1.NearFieldEvalBase" title="Permalink to this definition">¶</a></dt>
<dd><p>Base class of near-field evalulator.</p>
</dd></dl>

<dl class="class">
<dt id="volumential.list1.NearFieldFromCSR">
<em class="property">class </em><code class="sig-prename descclassname">volumential.list1.</code><code class="sig-name descname">NearFieldFromCSR</code><span class="sig-paren">(</span><em class="sig-param">integral_kernel</em>, <em class="sig-param">table_data_shapes</em>, <em class="sig-param">potential_kind=1</em>, <em class="sig-param">options=[]</em>, <em class="sig-param">name=None</em>, <em class="sig-param">device=None</em>, <em class="sig-param">**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/volumential/list1.html#NearFieldFromCSR"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#volumential.list1.NearFieldFromCSR" title="Permalink to this definition">¶</a></dt>
<dd><p>Evaluate the near-field potentials from CSR representation of the tree.
The class supports auto-scaling of simple kernels.</p>
<dl class="method">
<dt id="volumential.list1.NearFieldFromCSR.codegen_compute_scaling">
<code class="sig-name descname">codegen_compute_scaling</code><span class="sig-paren">(</span><em class="sig-param">box_name='sbox'</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/volumential/list1.html#NearFieldFromCSR.codegen_compute_scaling"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#volumential.list1.NearFieldFromCSR.codegen_compute_scaling" title="Permalink to this definition">¶</a></dt>
<dd><p>box_name: the name of the box whose extent is used.</p>
</dd></dl>

<dl class="method">
<dt id="volumential.list1.NearFieldFromCSR.codegen_exterior_part">
<code class="sig-name descname">codegen_exterior_part</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/volumential/list1.html#NearFieldFromCSR.codegen_exterior_part"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#volumential.list1.NearFieldFromCSR.codegen_exterior_part" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes the exterior contribution. This is nonzero for
inverse-type potentials like the fractional Laplacian.</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt>
<em class="property">class </em><code class="sig-prename descclassname">volumential.list1.</code><code class="sig-name descname">NearFieldEvalBase</code><span class="sig-paren">(</span><em class="sig-param">integral_kernel</em>, <em class="sig-param">table_data_shapes</em>, <em class="sig-param">potential_kind=1</em>, <em class="sig-param">options=[]</em>, <em class="sig-param">name=None</em>, <em class="sig-param">device=None</em>, <em class="sig-param">**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/volumential/list1.html#NearFieldEvalBase"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Base class of near-field evalulator.</p>
</dd></dl>

<dl class="class">
<dt>
<em class="property">class </em><code class="sig-prename descclassname">volumential.list1.</code><code class="sig-name descname">NearFieldFromCSR</code><span class="sig-paren">(</span><em class="sig-param">integral_kernel</em>, <em class="sig-param">table_data_shapes</em>, <em class="sig-param">potential_kind=1</em>, <em class="sig-param">options=[]</em>, <em class="sig-param">name=None</em>, <em class="sig-param">device=None</em>, <em class="sig-param">**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/volumential/list1.html#NearFieldFromCSR"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Evaluate the near-field potentials from CSR representation of the tree.
The class supports auto-scaling of simple kernels.</p>
<dl class="method">
<dt>
<code class="sig-name descname">codegen_compute_scaling</code><span class="sig-paren">(</span><em class="sig-param">box_name='sbox'</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/volumential/list1.html#NearFieldFromCSR.codegen_compute_scaling"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>box_name: the name of the box whose extent is used.</p>
</dd></dl>

<dl class="method">
<dt>
<code class="sig-name descname">codegen_exterior_part</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/volumential/list1.html#NearFieldFromCSR.codegen_exterior_part"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Computes the exterior contribution. This is nonzero for
inverse-type potentials like the fractional Laplacian.</p>
</dd></dl>

</dd></dl>

<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Use <a class="reference internal" href="#module-volumential.nearfield_potential_table" title="volumential.nearfield_potential_table"><code class="xref py py-mod docutils literal notranslate"><span class="pre">volumential.nearfield_potential_table</span></code></a> and <a class="reference internal" href="#module-volumential.table_manager" title="volumential.table_manager"><code class="xref py py-mod docutils literal notranslate"><span class="pre">volumential.table_manager</span></code></a> instead! <a class="reference internal" href="#module-volumential.list1" title="volumential.list1"><code class="xref py py-mod docutils literal notranslate"><span class="pre">volumential.list1</span></code></a> is deprecated and will be removed in the future.</p>
</div>
</div>
<div class="section" id="table-and-table-manager">
<h3>Table and Table Manager<a class="headerlink" href="#table-and-table-manager" title="Permalink to this headline">¶</a></h3>
<p>The tables are stored in <code class="docutils literal notranslate"><span class="pre">hdf5</span></code> format and managed through <code class="xref py py-class docutils literal notranslate"><span class="pre">NearFieldInteractionTableManager</span></code>.</p>
<span class="target" id="module-volumential.nearfield_potential_table"></span><dl class="class">
<dt id="volumential.nearfield_potential_table.NearFieldInteractionTable">
<em class="property">class </em><code class="sig-prename descclassname">volumential.nearfield_potential_table.</code><code class="sig-name descname">NearFieldInteractionTable</code><span class="sig-paren">(</span><em class="sig-param">quad_order</em>, <em class="sig-param">method='gauss-legendre'</em>, <em class="sig-param">dim=2</em>, <em class="sig-param">kernel_func=None</em>, <em class="sig-param">kernel_type=None</em>, <em class="sig-param">sumpy_kernel=None</em>, <em class="sig-param">build_method=None</em>, <em class="sig-param">source_box_extent=1</em>, <em class="sig-param">dtype=&lt;class 'numpy.float64'&gt;</em>, <em class="sig-param">inverse_droste=False</em>, <em class="sig-param">**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/volumential/nearfield_potential_table.html#NearFieldInteractionTable"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#volumential.nearfield_potential_table.NearFieldInteractionTable" title="Permalink to this definition">¶</a></dt>
<dd><p>Class for a near-field interaction table.</p>
<p>A near-field interaction table stores precomputed singular integrals
on template boxes and supports transforms to actual boxes on lookup.
The query process is done through scaling the entries based on actual
box sized.</p>
<p>Orientations are ordered counter-clockwise.</p>
<p>A template box is one of [0,1]^dim</p>
<dl class="method">
<dt id="volumential.nearfield_potential_table.NearFieldInteractionTable.build_kernel_exterior_normalizer_table">
<code class="sig-name descname">build_kernel_exterior_normalizer_table</code><span class="sig-paren">(</span><em class="sig-param">cl_ctx</em>, <em class="sig-param">queue</em>, <em class="sig-param">pool=None</em>, <em class="sig-param">ncpus=None</em>, <em class="sig-param">mesh_order=5</em>, <em class="sig-param">quad_order=10</em>, <em class="sig-param">mesh_size=0.03</em>, <em class="sig-param">remove_tmp_files=True</em>, <em class="sig-param">**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/volumential/nearfield_potential_table.html#NearFieldInteractionTable.build_kernel_exterior_normalizer_table"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#volumential.nearfield_potential_table.NearFieldInteractionTable.build_kernel_exterior_normalizer_table" title="Permalink to this definition">¶</a></dt>
<dd><p>Build the kernel exterior normalizer table for fractional Laplacians.</p>
<p>An exterior normalizer for kernel <span class="math notranslate nohighlight">\(G(r)\)</span> and target
<span class="math notranslate nohighlight">\(x\)</span> is defined as</p>
<div class="math notranslate nohighlight">
\[\int_{B^c} G(\lVert x - y \rVert) dy\]</div>
<p>where <span class="math notranslate nohighlight">\(B\)</span> is the source box <span class="math notranslate nohighlight">\([0, source_box_extent]^dim\)</span>.</p>
</dd></dl>

<dl class="method">
<dt id="volumential.nearfield_potential_table.NearFieldInteractionTable.build_normalizer_table">
<code class="sig-name descname">build_normalizer_table</code><span class="sig-paren">(</span><em class="sig-param">pool=None</em>, <em class="sig-param">pb=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/volumential/nearfield_potential_table.html#NearFieldInteractionTable.build_normalizer_table"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#volumential.nearfield_potential_table.NearFieldInteractionTable.build_normalizer_table" title="Permalink to this definition">¶</a></dt>
<dd><p>Build normalizers, used for log-scaled kernels,
currently only supported in 2D.</p>
</dd></dl>

<dl class="method">
<dt id="volumential.nearfield_potential_table.NearFieldInteractionTable.build_table_via_transform">
<code class="sig-name descname">build_table_via_transform</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/volumential/nearfield_potential_table.html#NearFieldInteractionTable.build_table_via_transform"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#volumential.nearfield_potential_table.NearFieldInteractionTable.build_table_via_transform" title="Permalink to this definition">¶</a></dt>
<dd><p>Build the full data table using transforms to
remove the singularity.</p>
</dd></dl>

<dl class="method">
<dt id="volumential.nearfield_potential_table.NearFieldInteractionTable.compute_table_entry">
<code class="sig-name descname">compute_table_entry</code><span class="sig-paren">(</span><em class="sig-param">entry_id</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/volumential/nearfield_potential_table.html#NearFieldInteractionTable.compute_table_entry"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#volumential.nearfield_potential_table.NearFieldInteractionTable.compute_table_entry" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute one entry in the table indexed by self.data[entry_id]</p>
<p>Input kernel function should be centered at origin.</p>
</dd></dl>

<dl class="method">
<dt id="volumential.nearfield_potential_table.NearFieldInteractionTable.decode_index">
<code class="sig-name descname">decode_index</code><span class="sig-paren">(</span><em class="sig-param">entry_id</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/volumential/nearfield_potential_table.html#NearFieldInteractionTable.decode_index"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#volumential.nearfield_potential_table.NearFieldInteractionTable.decode_index" title="Permalink to this definition">¶</a></dt>
<dd><p>This is the inverse function of get_entry_index()</p>
</dd></dl>

<dl class="method">
<dt id="volumential.nearfield_potential_table.NearFieldInteractionTable.find_target_point">
<code class="sig-name descname">find_target_point</code><span class="sig-paren">(</span><em class="sig-param">target_point_index</em>, <em class="sig-param">case_index</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/volumential/nearfield_potential_table.html#NearFieldInteractionTable.find_target_point"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#volumential.nearfield_potential_table.NearFieldInteractionTable.find_target_point" title="Permalink to this definition">¶</a></dt>
<dd><p>Apply proper transforms to find the target point’s coordinate.</p>
<p>Only translations and scalings are allowed in this step, avoiding the
indices of quad points to be messed up.</p>
</dd></dl>

<dl class="method">
<dt id="volumential.nearfield_potential_table.NearFieldInteractionTable.get_mode">
<code class="sig-name descname">get_mode</code><span class="sig-paren">(</span><em class="sig-param">mode_index</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/volumential/nearfield_potential_table.html#NearFieldInteractionTable.get_mode"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#volumential.nearfield_potential_table.NearFieldInteractionTable.get_mode" title="Permalink to this definition">¶</a></dt>
<dd><p>normal modes are deined on the source box</p>
</dd></dl>

<dl class="method">
<dt id="volumential.nearfield_potential_table.NearFieldInteractionTable.get_mode_cheb_coeffs">
<code class="sig-name descname">get_mode_cheb_coeffs</code><span class="sig-paren">(</span><em class="sig-param">mode_index</em>, <em class="sig-param">cheb_order</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/volumential/nearfield_potential_table.html#NearFieldInteractionTable.get_mode_cheb_coeffs"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#volumential.nearfield_potential_table.NearFieldInteractionTable.get_mode_cheb_coeffs" title="Permalink to this definition">¶</a></dt>
<dd><p>Cheb coeffs of a mode.
The projection process is performed on [0,1]^dim.</p>
</dd></dl>

<dl class="method">
<dt id="volumential.nearfield_potential_table.NearFieldInteractionTable.get_potential_scaler">
<code class="sig-name descname">get_potential_scaler</code><span class="sig-paren">(</span><em class="sig-param">entry_id</em>, <em class="sig-param">source_box_size=1</em>, <em class="sig-param">kernel_type=None</em>, <em class="sig-param">kernel_power=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/volumential/nearfield_potential_table.html#NearFieldInteractionTable.get_potential_scaler"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#volumential.nearfield_potential_table.NearFieldInteractionTable.get_potential_scaler" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a helper function to rescale the table entry based on
source_box’s actual size (edge length).</p>
</dd></dl>

<dl class="method">
<dt id="volumential.nearfield_potential_table.NearFieldInteractionTable.get_symmetry_transform">
<code class="sig-name descname">get_symmetry_transform</code><span class="sig-paren">(</span><em class="sig-param">source_mode_index</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/volumential/nearfield_potential_table.html#NearFieldInteractionTable.get_symmetry_transform"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#volumential.nearfield_potential_table.NearFieldInteractionTable.get_symmetry_transform" title="Permalink to this definition">¶</a></dt>
<dd><p>Apply proper transforms to map source mode to a reduced region</p>
<p>Returns:
- a transform that can be applied on the interaction case
vectors connection box centers.
- a transform that can be applied to the mode/point indices.</p>
</dd></dl>

<dl class="method">
<dt id="volumential.nearfield_potential_table.NearFieldInteractionTable.lookup_by_symmetry">
<code class="sig-name descname">lookup_by_symmetry</code><span class="sig-paren">(</span><em class="sig-param">entry_id</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/volumential/nearfield_potential_table.html#NearFieldInteractionTable.lookup_by_symmetry"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#volumential.nearfield_potential_table.NearFieldInteractionTable.lookup_by_symmetry" title="Permalink to this definition">¶</a></dt>
<dd><p>Loop up table entry that is mapped to a region where:
- k_i &lt;= q/2 in all direction i
- k_i’s are sorted in ascending order</p>
<p>Returns the mapped entry_id</p>
</dd></dl>

</dd></dl>

<span class="target" id="module-volumential.table_manager"></span><dl class="class">
<dt id="volumential.table_manager.NearFieldInteractionTableManager">
<em class="property">class </em><code class="sig-prename descclassname">volumential.table_manager.</code><code class="sig-name descname">NearFieldInteractionTableManager</code><span class="sig-paren">(</span><em class="sig-param">dataset_filename='nft.hdf5'</em>, <em class="sig-param">root_extent=1</em>, <em class="sig-param">dtype=&lt;class 'numpy.float64'&gt;</em>, <em class="sig-param">read_only='auto'</em>, <em class="sig-param">**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/volumential/table_manager.html#NearFieldInteractionTableManager"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#volumential.table_manager.NearFieldInteractionTableManager" title="Permalink to this definition">¶</a></dt>
<dd><p>A class that manages near field interaction table computation and
storage.</p>
<p>Tables are stored under ‘Dimension/KernelName/QuadOrder/BoxLevel/dataset_name’
e.g., ‘2D/Laplace/Order_1/Level_0/data’</p>
<p>Only one table manager can exist for a dataset file with write access.
The access can be controlled with the read_only argument. By default,
the constructor tries to open the dataset with write access, and falls
back to read-only if that fails.</p>
<dl class="method">
<dt id="volumential.table_manager.NearFieldInteractionTableManager.compute_and_update_table">
<code class="sig-name descname">compute_and_update_table</code><span class="sig-paren">(</span><em class="sig-param">dim</em>, <em class="sig-param">kernel_type</em>, <em class="sig-param">q_order</em>, <em class="sig-param">source_box_level=0</em>, <em class="sig-param">compute_method=None</em>, <em class="sig-param">cl_ctx=None</em>, <em class="sig-param">queue=None</em>, <em class="sig-param">**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/volumential/table_manager.html#NearFieldInteractionTableManager.compute_and_update_table"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#volumential.table_manager.NearFieldInteractionTableManager.compute_and_update_table" title="Permalink to this definition">¶</a></dt>
<dd><p>Performs the precomputation and stores the results.</p>
</dd></dl>

<dl class="method">
<dt id="volumential.table_manager.NearFieldInteractionTableManager.get_kernel_function">
<code class="sig-name descname">get_kernel_function</code><span class="sig-paren">(</span><em class="sig-param">dim</em>, <em class="sig-param">kernel_type</em>, <em class="sig-param">**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/volumential/table_manager.html#NearFieldInteractionTableManager.get_kernel_function"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#volumential.table_manager.NearFieldInteractionTableManager.get_kernel_function" title="Permalink to this definition">¶</a></dt>
<dd><p>Kernel function is needed for building the table. This function
provides support for some kernels such that the user can build and
use the table without explicitly providing such information.</p>
</dd></dl>

<dl class="method">
<dt id="volumential.table_manager.NearFieldInteractionTableManager.get_kernel_function_type">
<code class="sig-name descname">get_kernel_function_type</code><span class="sig-paren">(</span><em class="sig-param">dim</em>, <em class="sig-param">kernel_type</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/volumential/table_manager.html#NearFieldInteractionTableManager.get_kernel_function_type"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#volumential.table_manager.NearFieldInteractionTableManager.get_kernel_function_type" title="Permalink to this definition">¶</a></dt>
<dd><p>Determines how and to what extend the table data can be rescaled
and reused.</p>
</dd></dl>

<dl class="method">
<dt id="volumential.table_manager.NearFieldInteractionTableManager.get_sumpy_kernel">
<code class="sig-name descname">get_sumpy_kernel</code><span class="sig-paren">(</span><em class="sig-param">dim</em>, <em class="sig-param">kernel_type</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/volumential/table_manager.html#NearFieldInteractionTableManager.get_sumpy_kernel"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#volumential.table_manager.NearFieldInteractionTableManager.get_sumpy_kernel" title="Permalink to this definition">¶</a></dt>
<dd><p>Sumpy (symbolic) version of the kernel.</p>
</dd></dl>

<dl class="method">
<dt id="volumential.table_manager.NearFieldInteractionTableManager.get_table">
<code class="sig-name descname">get_table</code><span class="sig-paren">(</span><em class="sig-param">dim</em>, <em class="sig-param">kernel_type</em>, <em class="sig-param">q_order</em>, <em class="sig-param">source_box_level=0</em>, <em class="sig-param">force_recompute=False</em>, <em class="sig-param">compute_method=None</em>, <em class="sig-param">queue=None</em>, <em class="sig-param">**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/volumential/table_manager.html#NearFieldInteractionTableManager.get_table"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#volumential.table_manager.NearFieldInteractionTableManager.get_table" title="Permalink to this definition">¶</a></dt>
<dd><p>Primary user interface. Get the specified table regardless of how.
In the case of a cache miss or a forced re-computation, the method
specified in the compute_method will be used.</p>
</dd></dl>

<dl class="method">
<dt id="volumential.table_manager.NearFieldInteractionTableManager.load_saved_table">
<code class="sig-name descname">load_saved_table</code><span class="sig-paren">(</span><em class="sig-param">dim</em>, <em class="sig-param">kernel_type</em>, <em class="sig-param">q_order</em>, <em class="sig-param">source_box_level=0</em>, <em class="sig-param">compute_method=None</em>, <em class="sig-param">**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/volumential/table_manager.html#NearFieldInteractionTableManager.load_saved_table"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#volumential.table_manager.NearFieldInteractionTableManager.load_saved_table" title="Permalink to this definition">¶</a></dt>
<dd><p>Load a table saved in the hdf5 file.</p>
</dd></dl>

<dl class="method">
<dt id="volumential.table_manager.NearFieldInteractionTableManager.update_dataset">
<code class="sig-name descname">update_dataset</code><span class="sig-paren">(</span><em class="sig-param">group</em>, <em class="sig-param">dataset_name</em>, <em class="sig-param">data_array</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/volumential/table_manager.html#NearFieldInteractionTableManager.update_dataset"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#volumential.table_manager.NearFieldInteractionTableManager.update_dataset" title="Permalink to this definition">¶</a></dt>
<dd><p>Update stored data.</p>
</dd></dl>

</dd></dl>

</div>
</div>
<div class="section" id="module-volumential.expansion_wrangler_interface">
<span id="multipole-local-expansions"></span><h2>Multipole/Local Expansions<a class="headerlink" href="#module-volumential.expansion_wrangler_interface" title="Permalink to this headline">¶</a></h2>
<span class="target" id="module-volumential.expansion_wrangler_fpnd"></span><dl class="class">
<dt id="volumential.expansion_wrangler_fpnd.FPNDExpansionWrangler">
<em class="property">class </em><code class="sig-prename descclassname">volumential.expansion_wrangler_fpnd.</code><code class="sig-name descname">FPNDExpansionWrangler</code><span class="sig-paren">(</span><em class="sig-param">code_container</em>, <em class="sig-param">queue</em>, <em class="sig-param">tree</em>, <em class="sig-param">near_field_table</em>, <em class="sig-param">dtype</em>, <em class="sig-param">fmm_level_to_order</em>, <em class="sig-param">quad_order</em>, <em class="sig-param">potential_kind=1</em>, <em class="sig-param">source_extra_kwargs=None</em>, <em class="sig-param">kernel_extra_kwargs=None</em>, <em class="sig-param">self_extra_kwargs=None</em>, <em class="sig-param">list1_extra_kwargs=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/volumential/expansion_wrangler_fpnd.html#FPNDExpansionWrangler"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#volumential.expansion_wrangler_fpnd.FPNDExpansionWrangler" title="Permalink to this definition">¶</a></dt>
<dd><p>The default wrangler class.</p>
</dd></dl>

<dl class="class">
<dt id="volumential.expansion_wrangler_fpnd.FPNDExpansionWranglerCodeContainer">
<em class="property">class </em><code class="sig-prename descclassname">volumential.expansion_wrangler_fpnd.</code><code class="sig-name descname">FPNDExpansionWranglerCodeContainer</code><span class="sig-paren">(</span><em class="sig-param">cl_context</em>, <em class="sig-param">multipole_expansion_factory</em>, <em class="sig-param">local_expansion_factory</em>, <em class="sig-param">out_kernels</em>, <em class="sig-param">exclude_self=False</em>, <em class="sig-param">use_rscale=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/volumential/expansion_wrangler_fpnd.html#FPNDExpansionWranglerCodeContainer"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#volumential.expansion_wrangler_fpnd.FPNDExpansionWranglerCodeContainer" title="Permalink to this definition">¶</a></dt>
<dd><p>The default code container.</p>
</dd></dl>

<dl class="class">
<dt id="volumential.expansion_wrangler_fpnd.FPNDFMMLibExpansionWrangler">
<em class="property">class </em><code class="sig-prename descclassname">volumential.expansion_wrangler_fpnd.</code><code class="sig-name descname">FPNDFMMLibExpansionWrangler</code><span class="sig-paren">(</span><em class="sig-param">code_container</em>, <em class="sig-param">queue</em>, <em class="sig-param">tree</em>, <em class="sig-param">near_field_table</em>, <em class="sig-param">dtype</em>, <em class="sig-param">fmm_level_to_order</em>, <em class="sig-param">quad_order</em>, <em class="sig-param">potential_kind=1</em>, <em class="sig-param">source_extra_kwargs=None</em>, <em class="sig-param">kernel_extra_kwargs=None</em>, <em class="sig-param">self_extra_kwargs=None</em>, <em class="sig-param">list1_extra_kwargs=None</em>, <em class="sig-param">*args</em>, <em class="sig-param">**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/volumential/expansion_wrangler_fpnd.html#FPNDFMMLibExpansionWrangler"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#volumential.expansion_wrangler_fpnd.FPNDFMMLibExpansionWrangler" title="Permalink to this definition">¶</a></dt>
<dd><p>This expansion wrangler uses “fpnd” strategy. That is, Far field is
computed via Particle approximation and Near field is computed Directly.
The FMM is performed using FMMLib backend.</p>
<dl class="attribute">
<dt id="volumential.expansion_wrangler_fpnd.FPNDFMMLibExpansionWrangler.source_extra_kwargs">
<code class="sig-name descname">source_extra_kwargs</code><a class="headerlink" href="#volumential.expansion_wrangler_fpnd.FPNDFMMLibExpansionWrangler.source_extra_kwargs" title="Permalink to this definition">¶</a></dt>
<dd><p>Keyword arguments to be passed to interactions that involve
the source field.</p>
</dd></dl>

<dl class="attribute">
<dt id="volumential.expansion_wrangler_fpnd.FPNDFMMLibExpansionWrangler.kernel_extra_kwargs">
<code class="sig-name descname">kernel_extra_kwargs</code><a class="headerlink" href="#volumential.expansion_wrangler_fpnd.FPNDFMMLibExpansionWrangler.kernel_extra_kwargs" title="Permalink to this definition">¶</a></dt>
<dd><p>Keyword arguments to be passed to interactions that involve
expansions, but not the source field.</p>
</dd></dl>

<p>Much of this class is borrowed from pytential.qbx.fmmlib.</p>
<dl class="method">
<dt id="volumential.expansion_wrangler_fpnd.FPNDFMMLibExpansionWrangler.coarsen_multipoles">
<code class="sig-name descname">coarsen_multipoles</code><span class="sig-paren">(</span><em class="sig-param">level_start_source_parent_box_nrs</em>, <em class="sig-param">source_parent_boxes</em>, <em class="sig-param">mpoles</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/volumential/expansion_wrangler_fpnd.html#FPNDFMMLibExpansionWrangler.coarsen_multipoles"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#volumential.expansion_wrangler_fpnd.FPNDFMMLibExpansionWrangler.coarsen_multipoles" title="Permalink to this definition">¶</a></dt>
<dd><p>For each box in <em>source_parent_boxes</em>, gather (and translate)
the box’s children’s multipole expansions in <em>mpoles</em> and add
the resulting expansion into the box’s multipole expansion
in <em>mpoles</em>.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><em>mpoles</em></p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="volumential.expansion_wrangler_fpnd.FPNDFMMLibExpansionWrangler.eval_direct">
<code class="sig-name descname">eval_direct</code><span class="sig-paren">(</span><em class="sig-param">target_boxes</em>, <em class="sig-param">neighbor_source_boxes_starts</em>, <em class="sig-param">neighbor_source_boxes_lists</em>, <em class="sig-param">mode_coefs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/volumential/expansion_wrangler_fpnd.html#FPNDFMMLibExpansionWrangler.eval_direct"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#volumential.expansion_wrangler_fpnd.FPNDFMMLibExpansionWrangler.eval_direct" title="Permalink to this definition">¶</a></dt>
<dd><p>For each box in <em>target_boxes</em>, evaluate the influence of the
neighbor sources due to <em>src_weights</em></p>
<p>This step amounts to looking up the corresponding entries in a
pre-built table.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>a new potential array, see <a class="reference internal" href="#volumential.expansion_wrangler_fpnd.FPNDFMMLibExpansionWrangler.output_zeros" title="volumential.expansion_wrangler_fpnd.FPNDFMMLibExpansionWrangler.output_zeros"><code class="xref py py-meth docutils literal notranslate"><span class="pre">output_zeros()</span></code></a>.</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="volumential.expansion_wrangler_fpnd.FPNDFMMLibExpansionWrangler.eval_locals">
<code class="sig-name descname">eval_locals</code><span class="sig-paren">(</span><em class="sig-param">level_start_target_box_nrs</em>, <em class="sig-param">target_boxes</em>, <em class="sig-param">local_exps</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/volumential/expansion_wrangler_fpnd.html#FPNDFMMLibExpansionWrangler.eval_locals"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#volumential.expansion_wrangler_fpnd.FPNDFMMLibExpansionWrangler.eval_locals" title="Permalink to this definition">¶</a></dt>
<dd><p>For each box in <em>target_boxes</em>, evaluate the local expansion in
<em>local_exps</em> and return a new potential array.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>a new potential array, see <a class="reference internal" href="#volumential.expansion_wrangler_fpnd.FPNDFMMLibExpansionWrangler.output_zeros" title="volumential.expansion_wrangler_fpnd.FPNDFMMLibExpansionWrangler.output_zeros"><code class="xref py py-meth docutils literal notranslate"><span class="pre">output_zeros()</span></code></a>.</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="volumential.expansion_wrangler_fpnd.FPNDFMMLibExpansionWrangler.eval_multipoles">
<code class="sig-name descname">eval_multipoles</code><span class="sig-paren">(</span><em class="sig-param">target_boxes_by_source_level</em>, <em class="sig-param">source_boxes_by_level</em>, <em class="sig-param">mpole_exps</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/volumential/expansion_wrangler_fpnd.html#FPNDFMMLibExpansionWrangler.eval_multipoles"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#volumential.expansion_wrangler_fpnd.FPNDFMMLibExpansionWrangler.eval_multipoles" title="Permalink to this definition">¶</a></dt>
<dd><p>For each box in <em>target_boxes</em>, evaluate the multipole expansion in
<em>mpole_exps</em> in the nearby boxes given in <em>starts</em> and <em>lists</em>, and
return a new potential array.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>a new potential array, see <a class="reference internal" href="#volumential.expansion_wrangler_fpnd.FPNDFMMLibExpansionWrangler.output_zeros" title="volumential.expansion_wrangler_fpnd.FPNDFMMLibExpansionWrangler.output_zeros"><code class="xref py py-meth docutils literal notranslate"><span class="pre">output_zeros()</span></code></a>.</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="volumential.expansion_wrangler_fpnd.FPNDFMMLibExpansionWrangler.finalize_potentials">
<code class="sig-name descname">finalize_potentials</code><span class="sig-paren">(</span><em class="sig-param">potentials</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/volumential/expansion_wrangler_fpnd.html#FPNDFMMLibExpansionWrangler.finalize_potentials"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#volumential.expansion_wrangler_fpnd.FPNDFMMLibExpansionWrangler.finalize_potentials" title="Permalink to this definition">¶</a></dt>
<dd><p>Postprocess the reordered potentials. This is where global scaling
factors could be applied.</p>
</dd></dl>

<dl class="method">
<dt id="volumential.expansion_wrangler_fpnd.FPNDFMMLibExpansionWrangler.form_locals">
<code class="sig-name descname">form_locals</code><span class="sig-paren">(</span><em class="sig-param">level_start_target_or_target_parent_box_nrs</em>, <em class="sig-param">target_or_target_parent_boxes</em>, <em class="sig-param">starts</em>, <em class="sig-param">lists</em>, <em class="sig-param">src_weights</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/volumential/expansion_wrangler_fpnd.html#FPNDFMMLibExpansionWrangler.form_locals"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#volumential.expansion_wrangler_fpnd.FPNDFMMLibExpansionWrangler.form_locals" title="Permalink to this definition">¶</a></dt>
<dd><p>For each box in <em>target_or_target_parent_boxes</em>, form local
expansions due to the sources in the nearby boxes given in <em>starts</em> and
<em>lists</em>, and return a new local expansion array.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>a new local expansion array</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="volumential.expansion_wrangler_fpnd.FPNDFMMLibExpansionWrangler.form_multipoles">
<code class="sig-name descname">form_multipoles</code><span class="sig-paren">(</span><em class="sig-param">level_start_source_box_nrs</em>, <em class="sig-param">source_boxes</em>, <em class="sig-param">src_weights</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/volumential/expansion_wrangler_fpnd.html#FPNDFMMLibExpansionWrangler.form_multipoles"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#volumential.expansion_wrangler_fpnd.FPNDFMMLibExpansionWrangler.form_multipoles" title="Permalink to this definition">¶</a></dt>
<dd><p>Return an expansions array containing multipole expansions
in <em>source_boxes</em> due to sources with <em>src_weights</em>.</p>
</dd></dl>

<dl class="method">
<dt id="volumential.expansion_wrangler_fpnd.FPNDFMMLibExpansionWrangler.local_expansion_zeros">
<code class="sig-name descname">local_expansion_zeros</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/volumential/expansion_wrangler_fpnd.html#FPNDFMMLibExpansionWrangler.local_expansion_zeros"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#volumential.expansion_wrangler_fpnd.FPNDFMMLibExpansionWrangler.local_expansion_zeros" title="Permalink to this definition">¶</a></dt>
<dd><p>Construct arrays to store multipole expansions for all boxes</p>
</dd></dl>

<dl class="method">
<dt id="volumential.expansion_wrangler_fpnd.FPNDFMMLibExpansionWrangler.multipole_expansion_zeros">
<code class="sig-name descname">multipole_expansion_zeros</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/volumential/expansion_wrangler_fpnd.html#FPNDFMMLibExpansionWrangler.multipole_expansion_zeros"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#volumential.expansion_wrangler_fpnd.FPNDFMMLibExpansionWrangler.multipole_expansion_zeros" title="Permalink to this definition">¶</a></dt>
<dd><p>Construct arrays to store multipole expansions for all boxes</p>
</dd></dl>

<dl class="method">
<dt id="volumential.expansion_wrangler_fpnd.FPNDFMMLibExpansionWrangler.multipole_to_local">
<code class="sig-name descname">multipole_to_local</code><span class="sig-paren">(</span><em class="sig-param">level_start_target_box_nrs</em>, <em class="sig-param">target_boxes</em>, <em class="sig-param">src_box_starts</em>, <em class="sig-param">src_box_lists</em>, <em class="sig-param">mpole_exps</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/volumential/expansion_wrangler_fpnd.html#FPNDFMMLibExpansionWrangler.multipole_to_local"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#volumential.expansion_wrangler_fpnd.FPNDFMMLibExpansionWrangler.multipole_to_local" title="Permalink to this definition">¶</a></dt>
<dd><p>For each box in <em>target_or_target_parent_boxes</em>, translate and add
the influence of the multipole expansion in <em>mpole_exps</em> into a new
array of local expansions.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>a new (local) expansion array.</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="volumential.expansion_wrangler_fpnd.FPNDFMMLibExpansionWrangler.output_zeros">
<code class="sig-name descname">output_zeros</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/volumential/expansion_wrangler_fpnd.html#FPNDFMMLibExpansionWrangler.output_zeros"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#volumential.expansion_wrangler_fpnd.FPNDFMMLibExpansionWrangler.output_zeros" title="Permalink to this definition">¶</a></dt>
<dd><p>Construct arrays to store potential values for all target points</p>
</dd></dl>

<dl class="method">
<dt id="volumential.expansion_wrangler_fpnd.FPNDFMMLibExpansionWrangler.refine_locals">
<code class="sig-name descname">refine_locals</code><span class="sig-paren">(</span><em class="sig-param">level_start_target_or_target_parent_box_nrs</em>, <em class="sig-param">target_or_target_parent_boxes</em>, <em class="sig-param">local_exps</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/volumential/expansion_wrangler_fpnd.html#FPNDFMMLibExpansionWrangler.refine_locals"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#volumential.expansion_wrangler_fpnd.FPNDFMMLibExpansionWrangler.refine_locals" title="Permalink to this definition">¶</a></dt>
<dd><p>For each box in <em>child_boxes</em>,
translate the box’s parent’s local expansion in <em>local_exps</em> and add
the resulting expansion into the box’s local expansion in <em>local_exps</em>.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><em>local_exps</em></p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="volumential.expansion_wrangler_fpnd.FPNDFMMLibExpansionWrangler.reorder_potentials">
<code class="sig-name descname">reorder_potentials</code><span class="sig-paren">(</span><em class="sig-param">potentials</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/volumential/expansion_wrangler_fpnd.html#FPNDFMMLibExpansionWrangler.reorder_potentials"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#volumential.expansion_wrangler_fpnd.FPNDFMMLibExpansionWrangler.reorder_potentials" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a copy of <em>potentials</em> in user target order.
<em>source_weights</em> is in tree target order.</p>
</dd></dl>

<dl class="method">
<dt id="volumential.expansion_wrangler_fpnd.FPNDFMMLibExpansionWrangler.reorder_sources">
<code class="sig-name descname">reorder_sources</code><span class="sig-paren">(</span><em class="sig-param">source_array</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/volumential/expansion_wrangler_fpnd.html#FPNDFMMLibExpansionWrangler.reorder_sources"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#volumential.expansion_wrangler_fpnd.FPNDFMMLibExpansionWrangler.reorder_sources" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a copy of <em>source_array</em> in tree source order.
<em>source_array</em> is in user source order.</p>
</dd></dl>

<dl class="method">
<dt id="volumential.expansion_wrangler_fpnd.FPNDFMMLibExpansionWrangler.reorder_targets">
<code class="sig-name descname">reorder_targets</code><span class="sig-paren">(</span><em class="sig-param">target_array</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/volumential/expansion_wrangler_fpnd.html#FPNDFMMLibExpansionWrangler.reorder_targets"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#volumential.expansion_wrangler_fpnd.FPNDFMMLibExpansionWrangler.reorder_targets" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a copy of <em>target_array</em> in tree source order.
<em>target_array</em> is in user target order.</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="volumential.expansion_wrangler_fpnd.FPNDFMMLibExpansionWranglerCodeContainer">
<em class="property">class </em><code class="sig-prename descclassname">volumential.expansion_wrangler_fpnd.</code><code class="sig-name descname">FPNDFMMLibExpansionWranglerCodeContainer</code><span class="sig-paren">(</span><em class="sig-param">cl_context</em>, <em class="sig-param">multipole_expansion_factory</em>, <em class="sig-param">local_expansion_factory</em>, <em class="sig-param">out_kernels</em>, <em class="sig-param">exclude_self=True</em>, <em class="sig-param">*args</em>, <em class="sig-param">**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/volumential/expansion_wrangler_fpnd.html#FPNDFMMLibExpansionWranglerCodeContainer"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#volumential.expansion_wrangler_fpnd.FPNDFMMLibExpansionWranglerCodeContainer" title="Permalink to this definition">¶</a></dt>
<dd><p>Objects of this type serve as a place to keep the code needed
for ExpansionWrangler if it is using fmmlib to perform multipole
expansion and manipulations.</p>
<p>The interface is augmented with unecessary arguments acting as
placeholders, such that it can be a drop-in replacement of sumpy
backend.</p>
<dl class="method">
<dt id="volumential.expansion_wrangler_fpnd.FPNDFMMLibExpansionWranglerCodeContainer.get_wrangler">
<code class="sig-name descname">get_wrangler</code><span class="sig-paren">(</span><em class="sig-param">queue</em>, <em class="sig-param">tree</em>, <em class="sig-param">dtype</em>, <em class="sig-param">fmm_level_to_order</em>, <em class="sig-param">source_extra_kwargs={}</em>, <em class="sig-param">kernel_extra_kwargs=None</em>, <em class="sig-param">*args</em>, <em class="sig-param">**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/volumential/expansion_wrangler_fpnd.html#FPNDFMMLibExpansionWranglerCodeContainer.get_wrangler"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#volumential.expansion_wrangler_fpnd.FPNDFMMLibExpansionWranglerCodeContainer.get_wrangler" title="Permalink to this definition">¶</a></dt>
<dd><p>Makes a wrangler object.</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="volumential.expansion_wrangler_fpnd.FPNDSumpyExpansionWrangler">
<em class="property">class </em><code class="sig-prename descclassname">volumential.expansion_wrangler_fpnd.</code><code class="sig-name descname">FPNDSumpyExpansionWrangler</code><span class="sig-paren">(</span><em class="sig-param">code_container</em>, <em class="sig-param">queue</em>, <em class="sig-param">tree</em>, <em class="sig-param">near_field_table</em>, <em class="sig-param">dtype</em>, <em class="sig-param">fmm_level_to_order</em>, <em class="sig-param">quad_order</em>, <em class="sig-param">potential_kind=1</em>, <em class="sig-param">source_extra_kwargs=None</em>, <em class="sig-param">kernel_extra_kwargs=None</em>, <em class="sig-param">self_extra_kwargs=None</em>, <em class="sig-param">list1_extra_kwargs=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/volumential/expansion_wrangler_fpnd.html#FPNDSumpyExpansionWrangler"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#volumential.expansion_wrangler_fpnd.FPNDSumpyExpansionWrangler" title="Permalink to this definition">¶</a></dt>
<dd><p>This expansion wrangler uses “fpnd” strategy. That is, Far field is
computed via Particle approximation and Near field is computed Directly.
The FMM is performed using sumpy backend.</p>
<dl class="attribute">
<dt id="volumential.expansion_wrangler_fpnd.FPNDSumpyExpansionWrangler.source_extra_kwargs">
<code class="sig-name descname">source_extra_kwargs</code><a class="headerlink" href="#volumential.expansion_wrangler_fpnd.FPNDSumpyExpansionWrangler.source_extra_kwargs" title="Permalink to this definition">¶</a></dt>
<dd><p>Keyword arguments to be passed to interactions that involve
the source field.</p>
</dd></dl>

<dl class="attribute">
<dt id="volumential.expansion_wrangler_fpnd.FPNDSumpyExpansionWrangler.kernel_extra_kwargs">
<code class="sig-name descname">kernel_extra_kwargs</code><a class="headerlink" href="#volumential.expansion_wrangler_fpnd.FPNDSumpyExpansionWrangler.kernel_extra_kwargs" title="Permalink to this definition">¶</a></dt>
<dd><p>Keyword arguments to be passed to interactions that involve
expansions, but not the source field.</p>
</dd></dl>

<dl class="attribute">
<dt id="volumential.expansion_wrangler_fpnd.FPNDSumpyExpansionWrangler.self_extra_kwargs">
<code class="sig-name descname">self_extra_kwargs</code><a class="headerlink" href="#volumential.expansion_wrangler_fpnd.FPNDSumpyExpansionWrangler.self_extra_kwargs" title="Permalink to this definition">¶</a></dt>
<dd><p>Keyword arguments to be passed for handling
self interactions (singular integrals)</p>
</dd></dl>

<dl class="method">
<dt id="volumential.expansion_wrangler_fpnd.FPNDSumpyExpansionWrangler.coarsen_multipoles">
<code class="sig-name descname">coarsen_multipoles</code><span class="sig-paren">(</span><em class="sig-param">level_start_source_parent_box_nrs</em>, <em class="sig-param">source_parent_boxes</em>, <em class="sig-param">mpoles</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/volumential/expansion_wrangler_fpnd.html#FPNDSumpyExpansionWrangler.coarsen_multipoles"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#volumential.expansion_wrangler_fpnd.FPNDSumpyExpansionWrangler.coarsen_multipoles" title="Permalink to this definition">¶</a></dt>
<dd><p>For each box in <em>source_parent_boxes</em>, gather (and translate)
the box’s children’s multipole expansions in <em>mpoles</em> and add
the resulting expansion into the box’s multipole expansion
in <em>mpoles</em>.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><em>mpoles</em></p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="volumential.expansion_wrangler_fpnd.FPNDSumpyExpansionWrangler.eval_direct">
<code class="sig-name descname">eval_direct</code><span class="sig-paren">(</span><em class="sig-param">target_boxes</em>, <em class="sig-param">neighbor_source_boxes_starts</em>, <em class="sig-param">neighbor_source_boxes_lists</em>, <em class="sig-param">mode_coefs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/volumential/expansion_wrangler_fpnd.html#FPNDSumpyExpansionWrangler.eval_direct"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#volumential.expansion_wrangler_fpnd.FPNDSumpyExpansionWrangler.eval_direct" title="Permalink to this definition">¶</a></dt>
<dd><p>For each box in <em>target_boxes</em>, evaluate the influence of the
neighbor sources due to <em>src_weights</em></p>
<p>This step amounts to looking up the corresponding entries in a
pre-built table.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>a new potential array, see <a class="reference internal" href="#volumential.expansion_wrangler_fpnd.FPNDSumpyExpansionWrangler.output_zeros" title="volumential.expansion_wrangler_fpnd.FPNDSumpyExpansionWrangler.output_zeros"><code class="xref py py-meth docutils literal notranslate"><span class="pre">output_zeros()</span></code></a>.</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="volumential.expansion_wrangler_fpnd.FPNDSumpyExpansionWrangler.eval_locals">
<code class="sig-name descname">eval_locals</code><span class="sig-paren">(</span><em class="sig-param">level_start_target_box_nrs</em>, <em class="sig-param">target_boxes</em>, <em class="sig-param">local_exps</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/volumential/expansion_wrangler_fpnd.html#FPNDSumpyExpansionWrangler.eval_locals"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#volumential.expansion_wrangler_fpnd.FPNDSumpyExpansionWrangler.eval_locals" title="Permalink to this definition">¶</a></dt>
<dd><p>For each box in <em>target_boxes</em>, evaluate the local expansion in
<em>local_exps</em> and return a new potential array.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>a new potential array, see <a class="reference internal" href="#volumential.expansion_wrangler_fpnd.FPNDSumpyExpansionWrangler.output_zeros" title="volumential.expansion_wrangler_fpnd.FPNDSumpyExpansionWrangler.output_zeros"><code class="xref py py-meth docutils literal notranslate"><span class="pre">output_zeros()</span></code></a>.</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="volumential.expansion_wrangler_fpnd.FPNDSumpyExpansionWrangler.eval_multipoles">
<code class="sig-name descname">eval_multipoles</code><span class="sig-paren">(</span><em class="sig-param">target_boxes_by_source_level</em>, <em class="sig-param">source_boxes_by_level</em>, <em class="sig-param">mpole_exps</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/volumential/expansion_wrangler_fpnd.html#FPNDSumpyExpansionWrangler.eval_multipoles"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#volumential.expansion_wrangler_fpnd.FPNDSumpyExpansionWrangler.eval_multipoles" title="Permalink to this definition">¶</a></dt>
<dd><p>For each box in <em>target_boxes</em>, evaluate the multipole expansion in
<em>mpole_exps</em> in the nearby boxes given in <em>starts</em> and <em>lists</em>, and
return a new potential array.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>a new potential array, see <a class="reference internal" href="#volumential.expansion_wrangler_fpnd.FPNDSumpyExpansionWrangler.output_zeros" title="volumential.expansion_wrangler_fpnd.FPNDSumpyExpansionWrangler.output_zeros"><code class="xref py py-meth docutils literal notranslate"><span class="pre">output_zeros()</span></code></a>.</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="volumential.expansion_wrangler_fpnd.FPNDSumpyExpansionWrangler.finalize_potentials">
<code class="sig-name descname">finalize_potentials</code><span class="sig-paren">(</span><em class="sig-param">potentials</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/volumential/expansion_wrangler_fpnd.html#FPNDSumpyExpansionWrangler.finalize_potentials"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#volumential.expansion_wrangler_fpnd.FPNDSumpyExpansionWrangler.finalize_potentials" title="Permalink to this definition">¶</a></dt>
<dd><p>Postprocess the reordered potentials. This is where global scaling
factors could be applied.</p>
</dd></dl>

<dl class="method">
<dt id="volumential.expansion_wrangler_fpnd.FPNDSumpyExpansionWrangler.form_locals">
<code class="sig-name descname">form_locals</code><span class="sig-paren">(</span><em class="sig-param">level_start_target_or_target_parent_box_nrs</em>, <em class="sig-param">target_or_target_parent_boxes</em>, <em class="sig-param">starts</em>, <em class="sig-param">lists</em>, <em class="sig-param">src_weights</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/volumential/expansion_wrangler_fpnd.html#FPNDSumpyExpansionWrangler.form_locals"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#volumential.expansion_wrangler_fpnd.FPNDSumpyExpansionWrangler.form_locals" title="Permalink to this definition">¶</a></dt>
<dd><p>For each box in <em>target_or_target_parent_boxes</em>, form local
expansions due to the sources in the nearby boxes given in <em>starts</em> and
<em>lists</em>, and return a new local expansion array.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>a new local expansion array</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="volumential.expansion_wrangler_fpnd.FPNDSumpyExpansionWrangler.form_multipoles">
<code class="sig-name descname">form_multipoles</code><span class="sig-paren">(</span><em class="sig-param">level_start_source_box_nrs</em>, <em class="sig-param">source_boxes</em>, <em class="sig-param">src_weights</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/volumential/expansion_wrangler_fpnd.html#FPNDSumpyExpansionWrangler.form_multipoles"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#volumential.expansion_wrangler_fpnd.FPNDSumpyExpansionWrangler.form_multipoles" title="Permalink to this definition">¶</a></dt>
<dd><p>Return an expansions array containing multipole expansions
in <em>source_boxes</em> due to sources with <em>src_weights</em>.</p>
</dd></dl>

<dl class="method">
<dt id="volumential.expansion_wrangler_fpnd.FPNDSumpyExpansionWrangler.local_expansion_zeros">
<code class="sig-name descname">local_expansion_zeros</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/volumential/expansion_wrangler_fpnd.html#FPNDSumpyExpansionWrangler.local_expansion_zeros"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#volumential.expansion_wrangler_fpnd.FPNDSumpyExpansionWrangler.local_expansion_zeros" title="Permalink to this definition">¶</a></dt>
<dd><p>Construct arrays to store multipole expansions for all boxes</p>
</dd></dl>

<dl class="method">
<dt id="volumential.expansion_wrangler_fpnd.FPNDSumpyExpansionWrangler.multipole_expansion_zeros">
<code class="sig-name descname">multipole_expansion_zeros</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/volumential/expansion_wrangler_fpnd.html#FPNDSumpyExpansionWrangler.multipole_expansion_zeros"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#volumential.expansion_wrangler_fpnd.FPNDSumpyExpansionWrangler.multipole_expansion_zeros" title="Permalink to this definition">¶</a></dt>
<dd><p>Construct arrays to store multipole expansions for all boxes</p>
</dd></dl>

<dl class="method">
<dt id="volumential.expansion_wrangler_fpnd.FPNDSumpyExpansionWrangler.multipole_to_local">
<code class="sig-name descname">multipole_to_local</code><span class="sig-paren">(</span><em class="sig-param">level_start_target_box_nrs</em>, <em class="sig-param">target_boxes</em>, <em class="sig-param">src_box_starts</em>, <em class="sig-param">src_box_lists</em>, <em class="sig-param">mpole_exps</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/volumential/expansion_wrangler_fpnd.html#FPNDSumpyExpansionWrangler.multipole_to_local"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#volumential.expansion_wrangler_fpnd.FPNDSumpyExpansionWrangler.multipole_to_local" title="Permalink to this definition">¶</a></dt>
<dd><p>For each box in <em>target_or_target_parent_boxes</em>, translate and add
the influence of the multipole expansion in <em>mpole_exps</em> into a new
array of local expansions.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>a new (local) expansion array.</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="volumential.expansion_wrangler_fpnd.FPNDSumpyExpansionWrangler.output_zeros">
<code class="sig-name descname">output_zeros</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/volumential/expansion_wrangler_fpnd.html#FPNDSumpyExpansionWrangler.output_zeros"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#volumential.expansion_wrangler_fpnd.FPNDSumpyExpansionWrangler.output_zeros" title="Permalink to this definition">¶</a></dt>
<dd><p>Construct arrays to store potential values for all target points</p>
</dd></dl>

<dl class="method">
<dt id="volumential.expansion_wrangler_fpnd.FPNDSumpyExpansionWrangler.refine_locals">
<code class="sig-name descname">refine_locals</code><span class="sig-paren">(</span><em class="sig-param">level_start_target_or_target_parent_box_nrs</em>, <em class="sig-param">target_or_target_parent_boxes</em>, <em class="sig-param">local_exps</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/volumential/expansion_wrangler_fpnd.html#FPNDSumpyExpansionWrangler.refine_locals"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#volumential.expansion_wrangler_fpnd.FPNDSumpyExpansionWrangler.refine_locals" title="Permalink to this definition">¶</a></dt>
<dd><p>For each box in <em>child_boxes</em>,
translate the box’s parent’s local expansion in <em>local_exps</em> and add
the resulting expansion into the box’s local expansion in <em>local_exps</em>.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><em>local_exps</em></p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="volumential.expansion_wrangler_fpnd.FPNDSumpyExpansionWrangler.reorder_potentials">
<code class="sig-name descname">reorder_potentials</code><span class="sig-paren">(</span><em class="sig-param">potentials</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/volumential/expansion_wrangler_fpnd.html#FPNDSumpyExpansionWrangler.reorder_potentials"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#volumential.expansion_wrangler_fpnd.FPNDSumpyExpansionWrangler.reorder_potentials" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a copy of <em>potentials</em> in user target order.
<em>source_weights</em> is in tree target order.</p>
</dd></dl>

<dl class="method">
<dt id="volumential.expansion_wrangler_fpnd.FPNDSumpyExpansionWrangler.reorder_sources">
<code class="sig-name descname">reorder_sources</code><span class="sig-paren">(</span><em class="sig-param">source_array</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/volumential/expansion_wrangler_fpnd.html#FPNDSumpyExpansionWrangler.reorder_sources"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#volumential.expansion_wrangler_fpnd.FPNDSumpyExpansionWrangler.reorder_sources" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a copy of <em>source_array</em> in tree source order.
<em>source_array</em> is in user source order.</p>
</dd></dl>

<dl class="method">
<dt id="volumential.expansion_wrangler_fpnd.FPNDSumpyExpansionWrangler.reorder_targets">
<code class="sig-name descname">reorder_targets</code><span class="sig-paren">(</span><em class="sig-param">target_array</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/volumential/expansion_wrangler_fpnd.html#FPNDSumpyExpansionWrangler.reorder_targets"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#volumential.expansion_wrangler_fpnd.FPNDSumpyExpansionWrangler.reorder_targets" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a copy of <em>target_array</em> in tree source order.
<em>target_array</em> is in user target order.</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="volumential.expansion_wrangler_fpnd.FPNDSumpyExpansionWranglerCodeContainer">
<em class="property">class </em><code class="sig-prename descclassname">volumential.expansion_wrangler_fpnd.</code><code class="sig-name descname">FPNDSumpyExpansionWranglerCodeContainer</code><span class="sig-paren">(</span><em class="sig-param">cl_context</em>, <em class="sig-param">multipole_expansion_factory</em>, <em class="sig-param">local_expansion_factory</em>, <em class="sig-param">out_kernels</em>, <em class="sig-param">exclude_self=False</em>, <em class="sig-param">use_rscale=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/volumential/expansion_wrangler_fpnd.html#FPNDSumpyExpansionWranglerCodeContainer"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#volumential.expansion_wrangler_fpnd.FPNDSumpyExpansionWranglerCodeContainer" title="Permalink to this definition">¶</a></dt>
<dd><p>Objects of this type serve as a place to keep the code needed
for ExpansionWrangler if it is using sumpy to perform multipole
expansion and manipulations.</p>
<p>Since <code class="xref py py-class docutils literal notranslate"><span class="pre">SumpyExpansionWrangler</span></code> necessarily must have a
<code class="xref py py-class docutils literal notranslate"><span class="pre">pyopencl.CommandQueue</span></code>, but this queue is allowed to be
more ephemeral than the code, the code’s lifetime
is decoupled by storing it in this object.</p>
</dd></dl>

<dl class="function">
<dt id="volumential.expansion_wrangler_fpnd.inverse_id_map">
<code class="sig-prename descclassname">volumential.expansion_wrangler_fpnd.</code><code class="sig-name descname">inverse_id_map</code><span class="sig-paren">(</span><em class="sig-param">queue</em>, <em class="sig-param">mapped_ids</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/volumential/expansion_wrangler_fpnd.html#inverse_id_map"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#volumential.expansion_wrangler_fpnd.inverse_id_map" title="Permalink to this definition">¶</a></dt>
<dd><p>Given a index mapping as its mapped ids, compute its inverse,
and return the inverse by the inversely-mapped ids.</p>
</dd></dl>

</div>
<div class="section" id="volume-fmm">
<h2>Volume FMM<a class="headerlink" href="#volume-fmm" title="Permalink to this headline">¶</a></h2>
<p>The volume potential obtained from the volume FMM is over the internal box mesh.
To obtain the values on your own mesh points, an interpolation method is provided.
Although the interpolation is <span class="math notranslate nohighlight">\(O(N log N)\)</span>, it is almost always indistinguishable from
<span class="math notranslate nohighlight">\(O(N)\)</span> in practice as the geometry lookup usually takes up a very small fraction of
the total runtime.</p>
<span class="target" id="module-volumential.volume_fmm"></span><dl class="function">
<dt id="volumential.volume_fmm.drive_volume_fmm">
<code class="sig-prename descclassname">volumential.volume_fmm.</code><code class="sig-name descname">drive_volume_fmm</code><span class="sig-paren">(</span><em class="sig-param">traversal</em>, <em class="sig-param">expansion_wrangler</em>, <em class="sig-param">src_weights</em>, <em class="sig-param">src_func</em>, <em class="sig-param">direct_evaluation=False</em>, <em class="sig-param">timing_data=None</em>, <em class="sig-param">**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/volumential/volume_fmm.html#drive_volume_fmm"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#volumential.volume_fmm.drive_volume_fmm" title="Permalink to this definition">¶</a></dt>
<dd><p>Top-level driver routine for volume potential calculation
via fast multiple method.</p>
<p>This function, and the interface it utilizes, is adapted from boxtree/fmm.py</p>
<p>The fast multipole method is a two-pass algorithm:</p>
<p>1. During the fist (upward) pass, the multipole expansions for all boxes
at all levels are formed from bottom up.</p>
<p>2. In the second (downward) pass, the local expansions for all boxes
at all levels at formed from top down.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>traversal</strong> – A <code class="xref py py-class docutils literal notranslate"><span class="pre">boxtree.traversal.FMMTraversalInfo</span></code> instance.</p></li>
<li><p><strong>expansion_wrangler</strong> – An object implementing the expansion
wrangler interface.</p></li>
<li><p><strong>src_weights</strong> – Source ‘density/weights/charges’ time quad weights..
Passed unmodified to <em>expansion_wrangler</em>.</p></li>
<li><p><strong>src_func</strong> – Source ‘density/weights/charges’ function.
Passed unmodified to <em>expansion_wrangler</em>.</p></li>
</ul>
</dd>
</dl>
<p>Returns the potentials computed by <em>expansion_wrangler</em>.</p>
</dd></dl>

<dl class="function">
<dt id="volumential.volume_fmm.interpolate_volume_potential">
<code class="sig-prename descclassname">volumential.volume_fmm.</code><code class="sig-name descname">interpolate_volume_potential</code><span class="sig-paren">(</span><em class="sig-param">target_points</em>, <em class="sig-param">traversal</em>, <em class="sig-param">wrangler</em>, <em class="sig-param">potential</em>, <em class="sig-param">target_radii=None</em>, <em class="sig-param">lbl_lookup=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/volumential/volume_fmm.html#interpolate_volume_potential"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#volumential.volume_fmm.interpolate_volume_potential" title="Permalink to this definition">¶</a></dt>
<dd><p>Interpolate the volume potential, only works for tensor-product quadrature formulae.
target_points and potential should be an cl array.</p>
<p>wrangler is used only for general info (nothing sumpy kernel specific)</p>
</dd></dl>

<span class="target" id="module-volumential.list1"></span><dl class="class">
<dt>
<em class="property">class </em><code class="sig-prename descclassname">volumential.list1.</code><code class="sig-name descname">NearFieldEvalBase</code><span class="sig-paren">(</span><em class="sig-param">integral_kernel</em>, <em class="sig-param">table_data_shapes</em>, <em class="sig-param">potential_kind=1</em>, <em class="sig-param">options=[]</em>, <em class="sig-param">name=None</em>, <em class="sig-param">device=None</em>, <em class="sig-param">**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/volumential/list1.html#NearFieldEvalBase"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Base class of near-field evalulator.</p>
</dd></dl>

<dl class="class">
<dt>
<em class="property">class </em><code class="sig-prename descclassname">volumential.list1.</code><code class="sig-name descname">NearFieldFromCSR</code><span class="sig-paren">(</span><em class="sig-param">integral_kernel</em>, <em class="sig-param">table_data_shapes</em>, <em class="sig-param">potential_kind=1</em>, <em class="sig-param">options=[]</em>, <em class="sig-param">name=None</em>, <em class="sig-param">device=None</em>, <em class="sig-param">**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/volumential/list1.html#NearFieldFromCSR"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Evaluate the near-field potentials from CSR representation of the tree.
The class supports auto-scaling of simple kernels.</p>
<dl class="method">
<dt>
<code class="sig-name descname">codegen_compute_scaling</code><span class="sig-paren">(</span><em class="sig-param">box_name='sbox'</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/volumential/list1.html#NearFieldFromCSR.codegen_compute_scaling"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>box_name: the name of the box whose extent is used.</p>
</dd></dl>

<dl class="method">
<dt>
<code class="sig-name descname">codegen_exterior_part</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/volumential/list1.html#NearFieldFromCSR.codegen_exterior_part"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Computes the exterior contribution. This is nonzero for
inverse-type potentials like the fractional Laplacian.</p>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="function-extension">
<h2>Function Extension<a class="headerlink" href="#function-extension" title="Permalink to this headline">¶</a></h2>
<p>The <a class="reference internal" href="#module-volumential.function_extension" title="volumential.function_extension"><code class="xref py py-mod docutils literal notranslate"><span class="pre">volumential.function_extension</span></code></a> module provides helper functions to perform source density extensions using layer potentials.</p>
<span class="target" id="module-volumential.function_extension"></span></div>
<div class="section" id="module-volumential.tools">
<span id="miscellaneous-tools"></span><h2>Miscellaneous Tools<a class="headerlink" href="#module-volumential.tools" title="Permalink to this headline">¶</a></h2>
<dl class="class">
<dt id="volumential.tools.BoxSpecificMap">
<em class="property">class </em><code class="sig-prename descclassname">volumential.tools.</code><code class="sig-name descname">BoxSpecificMap</code><a class="reference internal" href="../_modules/volumential/tools.html#BoxSpecificMap"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#volumential.tools.BoxSpecificMap" title="Permalink to this definition">¶</a></dt>
<dd><p>Box-specific transform that maps between datum defined on quadrature
nodes. Being box-specific means that the transform for each box is
independent from the rest of the boxes.</p>
</dd></dl>

<dl class="class">
<dt id="volumential.tools.BoxSpecificReduction">
<em class="property">class </em><code class="sig-prename descclassname">volumential.tools.</code><code class="sig-name descname">BoxSpecificReduction</code><a class="reference internal" href="../_modules/volumential/tools.html#BoxSpecificReduction"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#volumential.tools.BoxSpecificReduction" title="Permalink to this definition">¶</a></dt>
<dd><p>Box-specific reduction that maps for each box a data vector defined
on the quadrature nodes to a scalar.
Being box-specific means that the reductions for each box is
independent from the rest of the boxes.</p>
</dd></dl>

<dl class="class">
<dt id="volumential.tools.BoxSum">
<em class="property">class </em><code class="sig-prename descclassname">volumential.tools.</code><code class="sig-name descname">BoxSum</code><span class="sig-paren">(</span><em class="sig-param">dim</em>, <em class="sig-param">degree</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/volumential/tools.html#BoxSum"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#volumential.tools.BoxSum" title="Permalink to this definition">¶</a></dt>
<dd><p>Adds up nodal values within each box.</p>
</dd></dl>

<dl class="class">
<dt id="volumential.tools.DiscreteLegendreTransform">
<em class="property">class </em><code class="sig-prename descclassname">volumential.tools.</code><code class="sig-name descname">DiscreteLegendreTransform</code><span class="sig-paren">(</span><em class="sig-param">dim</em>, <em class="sig-param">degree</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/volumential/tools.html#DiscreteLegendreTransform"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#volumential.tools.DiscreteLegendreTransform" title="Permalink to this definition">¶</a></dt>
<dd><p>Transform from nodal values to Legendre polynomial coefficients
for all cells (leaf boxes of a boxtree Tree object).
It is assumed that the traversal is built over a tree where the
sources and targets coincide.</p>
</dd></dl>

<dl class="class">
<dt id="volumential.tools.ScalarFieldExpressionEvaluation">
<em class="property">class </em><code class="sig-prename descclassname">volumential.tools.</code><code class="sig-name descname">ScalarFieldExpressionEvaluation</code><span class="sig-paren">(</span><em class="sig-param">dim</em>, <em class="sig-param">expression</em>, <em class="sig-param">variables=None</em>, <em class="sig-param">function_manglers=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/volumential/tools.html#ScalarFieldExpressionEvaluation"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#volumential.tools.ScalarFieldExpressionEvaluation" title="Permalink to this definition">¶</a></dt>
<dd><p>Evaluate a field funciton on a set of D-d points.
Useful for imposing analytic conditions efficiently.</p>
</dd></dl>

<dl class="function">
<dt id="volumential.tools.clean_file">
<code class="sig-prename descclassname">volumential.tools.</code><code class="sig-name descname">clean_file</code><span class="sig-paren">(</span><em class="sig-param">filename</em>, <em class="sig-param">new_name=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/volumential/tools.html#clean_file"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#volumential.tools.clean_file" title="Permalink to this definition">¶</a></dt>
<dd><p>Remove/rename file if exists.
Fails silently when the file does not exist.
Useful for, for example, writing output files that
are meant to overwrite existing ones.</p>
</dd></dl>

<dl class="function">
<dt id="volumential.tools.generate_leading_order_filtering">
<code class="sig-prename descclassname">volumential.tools.</code><code class="sig-name descname">generate_leading_order_filtering</code><span class="sig-paren">(</span><em class="sig-param">dim</em>, <em class="sig-param">n_dofs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/volumential/tools.html#generate_leading_order_filtering"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#volumential.tools.generate_leading_order_filtering" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a filtering vector that is an indicator function of the node
that corresponds to the leading order modal values in the Fourier space.</p>
</dd></dl>

<dl class="function">
<dt id="volumential.tools.import_code">
<code class="sig-prename descclassname">volumential.tools.</code><code class="sig-name descname">import_code</code><span class="sig-paren">(</span><em class="sig-param">code</em>, <em class="sig-param">name</em>, <em class="sig-param">add_to_sys_modules=True</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/volumential/tools.html#import_code"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#volumential.tools.import_code" title="Permalink to this definition">¶</a></dt>
<dd><p>Dynamically generates a module.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>code</strong> – can be any object containing code – string, file object, or</p>
</dd>
</dl>
<p>compiled code object. Returns a new module object initialized
by dynamically importing the given code and optionally adds it
to sys.modules under the given name.</p>
</dd></dl>

</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="../sphinx.html" class="btn btn-neutral float-right" title="Documentation Guide" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="../install.html" class="btn btn-neutral float-left" title="Installation and Setup" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2019, Xiaoyu Wei

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>